<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ritz Method: Convergence of the Solution - Course of Spacecraft Structures</title>
    
    <!-- MathJax Configuration -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
    
    <style>
        :root {
            --primary-color: #1a365d;
            --secondary-color: #2c5282;
            --accent-color: #38a169;
            --bg-light: #f7fafc;
            --bg-solution: #f0fff4;
            --bg-note: #ebf8ff;
            --bg-remark: #faf5ff;
            --border-color: #e2e8f0;
            --text-color: #2d3748;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 1.8;
            color: var(--text-color);
            background: #fff;
            padding: 40px 20px;
        }

        .document {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 50px;
            padding: 40px;
            background: var(--primary-color);
            color: white;
            border-radius: 8px;
        }

        header h1 {
            font-size: 2.2rem;
            margin-bottom: 20px;
        }

        header .course-info {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        header .author {
            font-style: italic;
            margin-top: 20px;
        }

        header .institution {
            font-size: 0.95rem;
            opacity: 0.9;
        }

        .section {
            margin: 40px 0;
            padding: 30px;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: var(--primary-color);
            font-size: 1.6rem;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--secondary-color);
        }

        .section h3 {
            color: var(--secondary-color);
            font-size: 1.3rem;
            margin: 25px 0 15px 0;
        }

        .section h4 {
            color: var(--secondary-color);
            font-size: 1.1rem;
            margin: 20px 0 10px 0;
        }

        p {
            margin: 15px 0;
            text-align: justify;
        }

        ul, ol {
            margin: 15px 0 15px 30px;
        }

        li {
            margin: 10px 0;
        }

        .boxed {
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            border-left: 4px solid var(--secondary-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .boxed h4 {
            color: var(--secondary-color);
            margin-top: 0;
            margin-bottom: 15px;
        }

        .note-box {
            background: var(--bg-note);
            border: 1px solid #bee3f8;
            border-left: 4px solid #3182ce;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .note-box h4 {
            color: #2b6cb0;
            margin-top: 0;
        }

        .remark-box {
            background: var(--bg-remark);
            border: 1px solid #e9d8fd;
            border-left: 4px solid #805ad5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .remark-box h4 {
            color: #6b46c1;
            margin-top: 0;
        }

        .example-section {
            border-left: 5px solid var(--accent-color);
        }

        .example-section h2 {
            border-bottom-color: var(--accent-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--border-color);
            padding: 12px 15px;
            text-align: center;
        }

        th {
            background: var(--primary-color);
            color: white;
            font-weight: normal;
        }

        tr:nth-child(even) {
            background: var(--bg-light);
        }

        tr:last-child {
            font-weight: bold;
            background: #e6fffa;
        }

        .diagram {
            margin: 25px 0;
            text-align: center;
        }

        .diagram img {
            max-width: 100%;
            height: auto;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: white;
            padding: 10px;
        }

        .diagram figcaption {
            margin-top: 10px;
            font-style: italic;
            color: #666;
            font-size: 0.9rem;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .graph-description {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            font-size: 0.9rem;
        }

        .graph-description h5 {
            color: var(--secondary-color);
            margin-bottom: 10px;
        }

        .equation-block {
            margin: 20px 0;
            padding: 15px;
            background: #fafafa;
            border-radius: 4px;
        }

        .definition {
            display: flex;
            gap: 20px;
            margin: 10px 0;
        }

        .definition-term {
            font-weight: bold;
            min-width: 80px;
        }

        .convergence-box {
            background: linear-gradient(135deg, #e6fffa 0%, #f0fff4 100%);
            border: 2px solid var(--accent-color);
            padding: 25px;
            margin: 25px 0;
            border-radius: 8px;
        }

        .warning-box {
            background: #fffaf0;
            border: 1px solid #fbd38d;
            border-left: 4px solid #dd6b20;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box h4 {
            color: #c05621;
            margin-top: 0;
        }

        .reference {
            font-size: 0.85rem;
            color: #666;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .subsection {
            margin: 30px 0;
            padding: 20px;
            background: #fafafa;
            border-radius: 6px;
        }

        .underline {
            text-decoration: underline;
        }

        mjx-container {
            margin: 10px 0 !important;
            overflow-x: auto;
        }

        @media (max-width: 768px) {
            body {
                padding: 20px 10px;
            }
            
            .section {
                padding: 20px;
            }

            .two-column {
                grid-template-columns: 1fr;
            }

            header {
                padding: 25px;
            }

            header h1 {
                font-size: 1.6rem;
            }

            table {
                font-size: 0.8rem;
            }

            th, td {
                padding: 8px 5px;
            }
        }
    </style>
</head>
<body>
    <article class="document">
        <header>
            <h1>Ritz Method: Convergence of the Solution</h1>
            <div class="course-info">Course of Spacecraft Structures</div>
            <div class="course-info">AY 2017/2018</div>
            <div class="author">Riccardo Vescovini</div>
            <div class="institution">Politecnico di Milano, Department of Aerospace Science and Technology</div>
        </header>

        <main>
            <!-- Section: Measures of the Errors -->
            <section class="section" id="measures-of-errors">
                <h2>Measures of the Errors</h2>
                
                <p>Results are presented with regard to four examples aimed at illustrating the convergence of the Ritz method for 1D problems.</p>
                
                <p>Two norms are introduced to measure the error due to the Ritz approximation:</p>

                <div class="boxed">
                    <h4>Error Measures</h4>
                    \[||e^f||_{L_2} = \frac{\sqrt{\int_0^l \left(f - \tilde{f}\right)^2 \text{d}x}}{\int_0^l f \text{d}x}\]
                    
                    \[||e^f||_{\text{inf}} = \max |f - \tilde{f}|\]
                    
                    <p><strong>\(f\):</strong> exact solution</p>
                    <p><strong>\(\tilde{f}\):</strong> Ritz solution</p>
                </div>

                <ul>
                    <li>The \(\text{L}_2\) norm provides a measure of the <span class="underline">global</span> error, i.e. over the entire domain. The normalization factor at the denominator is introduced to express the average percent difference between the exact and the approximate solution.</li>
                    <li>The inf norm provides a measure of the maximum error at <span class="underline">local</span> level (the norm is not normalized as the exact solution could be locally zero, leading to a singularity).</li>
                </ul>

                <h3>Convergence Definitions</h3>
                
                <p>The convergence in the \(\text{L}_2\) and inf norm is defined as:</p>

                <div class="convergence-box">
                    <h4>Convergence</h4>
                    \[\lim_{N \to +\infty} ||e_N^f||_{L_2} = 0\]
                    \[\lim_{N \to +\infty} ||e_N^f||_{\infty} = 0\]
                    <p><strong>\(N\):</strong> number of terms of the Ritz approximation</p>
                </div>

                <p>Note that convergence in the inf norm implies convergence in the \(\text{L}_2\) norm, but NOT viceversa. In other words, the convergence in the inf norm is a stronger requirement with respect to the convergence in the \(\text{L}_2\) norm.</p>
            </section>

            <!-- Section: Convergence Theory -->
            <section class="section" id="convergence">
                <h2>Convergence</h2>
                
                <p>For the Ritz method (at least for 1D problems) the following results hold:</p>

                <ol>
                    <li>
                        <p><span class="underline">The convergence is guaranteed for the unknown function and its derivatives up to the highest order of differentiation entering the generalized deformation parameters.</span> For the Euler-Bernoulli beam model, the convergence is thus guaranteed for the bending displacement up to the second derivative (bending moment). Note that convergence of the shear, which is associated with the third derivative, could be obtained but is not guaranteed.</p>
                    </li>
                    <li>
                        <p><span class="underline">The convergence is guaranteed in the inf norm for continuous fields.</span> Thus displacements (and rotations) converge in the inf norm, as they are always continuous quantities. Bending moments converge in the inf norm when they are continuous, whilst the convergence can be only in the \(\text{L}_2\) norm when a discontinuity exists.</p>
                    </li>
                </ol>

                <h3>Additional Properties</h3>

                <ol>
                    <li>
                        <p>The total potential energy converges monotonically from beyond (or, equivalently, the strain energy converges monotonically from below):</p>
                        \[\Pi_1 \geq \Pi_2 \geq \ldots \geq \Pi_N \geq \Pi_{exact}\]
                        <p>with \(\Pi_i\) total potential energy using \(i\) terms</p>
                        \[U_1 \leq U_2 \leq \ldots \leq U_N \leq U_{exact}\]
                        <p>with \(U_i\) strain energy using \(i\) terms</p>
                        <p>In other words, <span class="underline">the stiffness of the structural model is globally relaxed as the number of degrees of freedom is increased.</span></p>
                        <p>This result does not imply that the local displacements obtained using M dofs are necessarily higher (in absolute value) with respect to the displacement obtained using N dofs, with M&gt;N</p>
                    </li>
                    <li>
                        <p>The rapidity of convergence reduces as the order of the derivatives is increased. It follows that bending moments converge slower with respect to the rotations which, in turn, converge slower than the displacements.</p>
                    </li>
                </ol>
            </section>

            <!-- Example 1: Beam with Distributed Load -->
            <section class="section example-section" id="example-1">
                <h2>Example 1: Beam with Distributed Load</h2>

                <figure class="diagram">
                    <img src="images/Lab_02_Ritz_beams/simply_supported_beam_distributed_load.png" alt="Simply supported beam with uniformly distributed load q over entire length, showing supports at both ends and beam properties EJ,l">
                    <figcaption>Figure 1: Simply supported beam with uniformly distributed load</figcaption>
                </figure>

                <div class="two-column">
                    <div class="boxed">
                        <h4>Essential Conditions</h4>
                        \[\begin{cases} w(0) = 0 \\ w(l) = 0 \end{cases}\]
                    </div>
                    
                    <div class="boxed">
                        <h4>Ritz Functions</h4>
                        \[\phi(x) = x^{i+1} - l^i x \quad i = 1 \ldots N\]
                        \[\phi(x) = \sin \frac{i\pi x}{l} \quad i = 1 \ldots N\]
                    </div>
                </div>

                <div class="two-column">
                    <div class="boxed">
                        <h4>Nondimensional Parameters</h4>
                        \[\overline{w} = w \frac{EJ}{ql^4} \quad \overline{M} = M \frac{1}{ql^2}\]
                        \[\overline{Q} = Q \frac{1}{ql} \quad \overline{\Pi} = \Pi \frac{EJ}{q^2 l^5}\]
                    </div>
                    
                    <div class="boxed">
                        <h4>Exact Solution</h4>
                        \[w = \frac{ql^4}{24EJ} \left[ \left(\frac{x}{l}\right)^4 - 2\left(\frac{x}{l}\right)^3 + \frac{x}{l} \right]\]
                        \[M = -EJw_{,xx} = qx\frac{l-x}{2}\]
                        \[Q = -EJw_{,xxx} = q\left(\frac{l}{2} - x\right)\]
                        \[\Pi = -\frac{1}{240EJ}q^2l^5\]
                    </div>
                </div>

                <div class="note-box">
                    <h4>Note</h4>
                    <p>The bending moment (and, clearly, the displacement) is a continuous function: convergence is thus expected in the inf norm.</p>
                </div>

                <h3>Results Using N Trigonometric Functions</h3>

                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(\overline{w}(l/2) \cdot 10^2\)</th>
                            <th>\(\overline{M}(l/2) \cdot 10\)</th>
                            <th>\(\overline{\Pi} \cdot 10^3\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>1.3071</td><td>1.2901</td><td>-4.1606</td></tr>
                        <tr><td>N = 3</td><td>1.3017</td><td>1.2423</td><td>-4.1664</td></tr>
                        <tr><td>N = 5</td><td>1.3021</td><td>1.2526</td><td>-4.1666</td></tr>
                        <tr><td>N = 25</td><td>1.3021</td><td>1.2500</td><td>-4.1667</td></tr>
                        <tr><td>exact</td><td>1.3021</td><td>1.2500</td><td>-4.1667</td></tr>
                    </tbody>
                </table>

                <div class="remark-box">
                    <h4>Remarks</h4>
                    <ul>
                        <li>The mid-displacement reaches convergence quickly: 5 trial functions are sufficient for reaching the exact solution.</li>
                        <li>The solution obtained with 1 term is a good approximation of the exact solution (the percent different with respect to the convergence solution is small). <span class="underline">Note that the solution with N=1 is associated with a higher displacement with respect to the solutions obtained with N&gt;1</span> (this result is local and does not inficiate the observation regarding the higher stiffness of models with less dofs).</li>
                        <li>The convergence of the bending moment, which is obtained by taking the second derivative of the displacement, is slower with respect to the transverse displacement. The convergence, at local level, is not monothonical.</li>
                        <li>The convergence of the total potential energy is quite fast. Few degrees of freedom allows to capture the exact value with a good degree of approximation.</li>
                        <li>The converegence of the total potential energy is monothonical (in this sense, <span class="underline">the numerical model becomes more and more compliant as N increases</span>).</li>
                    </ul>
                </div>

                <h3>Errors Using N Trigonometric Functions</h3>

                <h4>Infinity Norm Errors</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{\infty} 10^5\)</th>
                            <th>\(||e^{M}||_{\infty} 10^3\)</th>
                            <th>\(||e^{\overline{Q}}||_{\infty} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>5.5734</td><td>5.3193</td><td>9.4715</td></tr>
                        <tr><td>N = 3</td><td>0.4938</td><td>1.4810</td><td>4.9684</td></tr>
                        <tr><td>N = 5</td><td>0.1063</td><td>0.6740</td><td>3.3472</td></tr>
                        <tr><td>N = 25</td><td>0.0003</td><td>0.0366</td><td>0.7790</td></tr>
                    </tbody>
                </table>

                <h4>\(L_2\) Norm Errors</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{L_2} 10^2\)</th>
                            <th>\(||e^{M}||_{L_2} 10^2\)</th>
                            <th>\(||e^{Q}||_{L_2} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>0.4128</td><td>3.8013</td><td>12.0275</td></tr>
                        <tr><td>N = 3</td><td>0.0326</td><td>0.8673</td><td>4.7946</td></tr>
                        <tr><td>N = 5</td><td>0.0062</td><td>0.3364</td><td>2.6868</td></tr>
                        <tr><td>N = 25</td><td>0.0000</td><td>0.0091</td><td>0.3058</td></tr>
                    </tbody>
                </table>

                <div class="remark-box">
                    <h4>Remarks</h4>
                    <ul>
                        <li>The displacement and the bending moments are continuous functions and, as expected, the solution converges in the inf and \(L_2\) norms.</li>
                        <li>Although not guaranteed, the convergence is achieved, in this specific case, also for the shear in both the norms.</li>
                        <li>The errors in the \(L_2\) norm clearly illustrate the different rapidity of convergence of displacement, moment and shear. The errors obtained using N=5 are 0.01%, 0.34% and 2.69% for these three quantities, respectively.</li>
                    </ul>
                </div>

                <h3>Results Using Polynomial Functions</h3>

                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(\overline{w}(l/2) \cdot 10^2\)</th>
                            <th>\(\overline{M}(l/2) \cdot 10\)</th>
                            <th>\(\overline{\Pi} \cdot 10^3\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>1.0417</td><td>0.8333</td><td>-3.4722</td></tr>
                        <tr><td>N = 3</td><td>1.3021</td><td>1.2500</td><td>-4.1667</td></tr>
                        <tr><td>N = 5</td><td>1.3021</td><td>1.2500</td><td>-4.1667</td></tr>
                        <tr><td>exact</td><td>1.3021</td><td>1.2500</td><td>-4.1667</td></tr>
                    </tbody>
                </table>

                <h4>Infinity Norm Errors (Polynomial)</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{\infty} 10^2\)</th>
                            <th>\(||e^{M}||_{\infty} 10^2\)</th>
                            <th>\(||e^{Q}||_{\infty} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>260.4167</td><td>83.3333</td><td>50.0000</td></tr>
                        <tr><td>N = 3</td><td>0.0000</td><td>0.0000</td><td>0.0000</td></tr>
                        <tr><td>N = 5</td><td>0.0000</td><td>0.0000</td><td>0.0000</td></tr>
                    </tbody>
                </table>

                <h4>\(L_2\) Norm Errors (Polynomial)</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{L_2} 10^2\)</th>
                            <th>\(||e^{M}||_{L_2} 10^2\)</th>
                            <th>\(||e^{Q}||_{L_2} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>17.9605</td><td>40.8250</td><td>100.0000</td></tr>
                        <tr><td>N = 3</td><td>0.0000</td><td>0.0000</td><td>0.0000</td></tr>
                        <tr><td>N = 5</td><td>0.0000</td><td>0.0000</td><td>0.0000</td></tr>
                    </tbody>
                </table>

                <div class="remark-box">
                    <h4>Remarks</h4>
                    <ul>
                        <li>In this case, the space spanned by the Ritz basis contains also the exact solution. Indeed the Ritz approximation converges to the exact solution with 3 dofs (when the quartic term is accounted for).</li>
                        <li>Note that the 1 dof solution is less accurate with respect to the 1 dof solution obtained using the trigonometric expansion.</li>
                    </ul>
                </div>
            </section>

            <!-- Example 2: Beam with Concentrated Load -->
            <section class="section example-section" id="example-2">
                <h2>Example 2: Beam with Concentrated Load</h2>

                <figure class="diagram">
                    <img src="images/Lab_02_Ritz_beams/simply_supported_beam_point_load.png" alt="Simply supported beam with concentrated point load P at mid-span, showing support conditions and beam properties EJ,l">
                    <figcaption>Figure 2: Simply supported beam with concentrated point load at mid-span</figcaption>
                </figure>

                <div class="two-column">
                    <div class="boxed">
                        <h4>Essential Conditions</h4>
                        \[\begin{cases} w(0) = 0 \\ w(l) = 0 \end{cases}\]
                    </div>
                    
                    <div class="boxed">
                        <h4>Ritz Functions</h4>
                        \[\phi(x) = x^{i+1} - l^i x \quad i = 1 \ldots N\]
                        \[\phi(x) = \sin \frac{i\pi x}{l} \quad i = 1 \ldots N\]
                    </div>
                </div>

                <div class="two-column">
                    <div class="boxed">
                        <h4>Nondimensional Parameters</h4>
                        \[\overline{w} = w \frac{EJ}{Pl^3} \quad \overline{M} = M \frac{1}{Pl}\]
                        \[\overline{Q} = Q \frac{1}{P} \quad \overline{\Pi} = \Pi \frac{EJ}{P^2 l^3}\]
                    </div>
                    
                    <div class="boxed">
                        <h4>Exact Solution</h4>
                        <p>Solution for \(0 \leq x \leq l/2\) (anti-symmetric)</p>
                        \[w = \frac{Pl^3}{48EJ} \left[ 4\left(\frac{x}{l}\right)^3 - 3\frac{x}{l} \right]\]
                        \[M = -\frac{1}{2}Px\]
                        \[Q = -\frac{P}{2}\]
                        \[\Pi = -\frac{P^2 l^3}{96EJ}\]
                    </div>
                </div>

                <div class="note-box">
                    <h4>Note</h4>
                    <p>The shear is discontinuous (and the bending moment is characterized by a discontinuity of the first derivative). The exact solution cannot be achieved using global functions.</p>
                </div>

                <h3>Results Using N Trigonometric Functions</h3>

                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(\overline{w}(l/2) \cdot 10^2\)</th>
                            <th>\(\overline{M}(l/2) \cdot 10\)</th>
                            <th>\(\overline{\Pi} \cdot 10^3\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>-2.0532</td><td>-2.0264</td><td>-10.2660</td></tr>
                        <tr><td>N = 3</td><td>-2.0785</td><td>-2.2516</td><td>-10.3927</td></tr>
                        <tr><td>N = 5</td><td>-2.0818</td><td>-2.3326</td><td>-10.4091</td></tr>
                        <tr><td>N = 25</td><td>-2.0833</td><td>-2.4610</td><td>-10.4166</td></tr>
                        <tr><td>exact</td><td>-2.0833</td><td>-2.5000</td><td>-10.4167</td></tr>
                    </tbody>
                </table>

                <div class="remark-box">
                    <h4>Remarks</h4>
                    <ul>
                        <li>As observed in the previous example, the convergence in terms of displacements is quite fast, and so is the convergence of the total potential energy.</li>
                        <li>An accurate estimate of the bending moment is possible only if a relatively large number of dofs is used. The convergence of the second derivatives is slower.</li>
                    </ul>
                </div>

                <h3>Errors Using N Trigonometric Functions</h3>

                <h4>Infinity Norm Errors</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{\infty} 10^5\)</th>
                            <th>\(||e^{M}||_{\infty} 10^3\)</th>
                            <th>\(||e^{\overline{Q}}||_{\infty} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>30.1369</td><td>47.3576</td><td>50.0000</td></tr>
                        <tr><td>N = 3</td><td>4.7888</td><td>24.8418</td><td>50.0000</td></tr>
                        <tr><td>N = 5</td><td>1.5037</td><td>16.7361</td><td>50.0000</td></tr>
                        <tr><td>N = 25</td><td>0.0194</td><td>3.8951</td><td>50.0000</td></tr>
                    </tbody>
                </table>

                <h4>\(L_2\) Norm Errors</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{L_2} 10^2\)</th>
                            <th>\(||e^{M}||_{L_2} 10^2\)</th>
                            <th>\(||e^{Q}||_{L_2} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>1.2456</td><td>12.0275</td><td>43.5238</td></tr>
                        <tr><td>N = 3</td><td>0.1662</td><td>4.7946</td><td>31.5230</td></tr>
                        <tr><td>N = 5</td><td>0.0451</td><td>2.6868</td><td>25.8744</td></tr>
                        <tr><td>N = 25</td><td>0.0003</td><td>0.3058</td><td>12.4890</td></tr>
                    </tbody>
                </table>

                <div class="remark-box">
                    <h4>Remarks</h4>
                    <ul>
                        <li>The displacements and the bending moment converge in the inf norm (they are continuous functions, so convergence is guaranteed in the inf norm).</li>
                        <li>On the contrary, the shear force does not converge in the inf norm. Convergence is observed only at global level (although for the shear it is not guaranteed a priori), but it is very slow: when N=25 the error is 12.5%!</li>
                    </ul>
                </div>

                <h3>Comparison of Internal Shear Approximation (N=1,...,25 terms)</h3>
                
                <p>As N is increased, the description of the shear force is better approximated in a global sense only. For polynomials, a Gibbs-like effect can be noted, with strong oscillations and local errors close to the boundaries.</p>
            </section>

            <!-- Example 3: Beam with Concentrated Moment -->
            <section class="section example-section" id="example-3">
                <h2>Example 3: Beam with Concentrated Moment</h2>

                <figure class="diagram">
                    <img src="images/Lab_02_Ritz_beams/simply_supported_beam_concentrated_moment.png" alt="Simply supported beam with concentrated moment M applied at left support, showing support conditions and beam properties EJ,l">
                    <figcaption>Figure 3: Simply supported beam with concentrated moment at left support</figcaption>
                </figure>

                <div class="two-column">
                    <div class="boxed">
                        <h4>Essential Conditions</h4>
                        \[\begin{cases} w(0) = 0 \\ w(l) = 0 \end{cases}\]
                    </div>
                    
                    <div class="boxed">
                        <h4>Ritz Functions</h4>
                        \[\phi(x) = x^{i+1} - l^i x \quad i = 1 \ldots N\]
                        \[\phi(x) = \sin \frac{i\pi x}{l} \quad i = 1 \ldots N\]
                    </div>
                </div>

                <div class="two-column">
                    <div class="boxed">
                        <h4>Nondimensional Parameters</h4>
                        \[\overline{w} = w \frac{EJ}{\hat{M}l^2} \quad \overline{M} = M \frac{1}{\hat{M}}\]
                        \[\overline{Q} = Q \frac{l}{\hat{M}} \quad \overline{\Pi} = \Pi \frac{EJ}{\hat{M}^2 l}\]
                    </div>
                    
                    <div class="boxed">
                        <h4>Exact Solution</h4>
                        <p>Solution for \(0 \leq x \leq l/2\) (anti-symmetric)</p>
                        \[w = \frac{\hat{M}l^2}{EJ} \left[ \frac{1}{6}\left(\frac{x}{l}\right)^3 - \frac{1}{24}\left(\frac{x}{l}\right) \right]\]
                        \[M = -\hat{M}\frac{x}{l}\]
                        \[Q = -\frac{\hat{M}}{l}\]
                        \[\Pi = -\frac{\hat{M}^2 l}{24EJ}\]
                    </div>
                </div>

                <div class="note-box">
                    <h4>Note</h4>
                    <p>The bending moment is now discontinuous: it is then expected that convergence can be achieved only in the \(L_2\) norm.</p>
                </div>

                <h3>Results Using N Trigonometric Functions</h3>

                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(\overline{w}(l/4) \cdot 10^2\)</th>
                            <th>\(\overline{M}(l/4) \cdot 10\)</th>
                            <th>\(\overline{\Pi} \cdot 10^3\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 2</td><td>-0.8063</td><td>-3.1831</td><td>-25.3303</td></tr>
                        <tr><td>N = 4</td><td>-0.8063</td><td>-3.1831</td><td>-31.6629</td></tr>
                        <tr><td>N = 6</td><td>-0.7764</td><td>-2.1221</td><td>-34.4773</td></tr>
                        <tr><td>N = 26</td><td>-0.7814</td><td>-2.6131</td><td>-39.7912</td></tr>
                        <tr><td>exact</td><td>-0.7813</td><td>-2.5000</td><td>-41.6667</td></tr>
                    </tbody>
                </table>

                <div class="remark-box">
                    <h4>Remarks</h4>
                    <ul>
                        <li>The displacements and bending moments are now evaluated in l/4 as they are zero and discontinuous, respectively, in l/2.</li>
                        <li>The total potential energy converges monotonically, as guaranteed for any Ritz approximation.</li>
                        <li>In this case, also the displacement converges monothonically (this is not always guaranteed – see example 1 –, but in the presence of concentrated loads it is).</li>
                        <li>On the contrary, the bending moment is now converging with an oscillating behaviour.</li>
                    </ul>
                </div>

                <h3>Errors Using N Trigonometric Functions</h3>

                <h4>Infinity Norm Errors</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{\infty} 10^5\)</th>
                            <th>\(||e^{M}||_{\infty} 10^3\)</th>
                            <th>\(||e^{\overline{Q}}||_{\infty} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>127.6503</td><td>500.00</td><td>300.00</td></tr>
                        <tr><td>N = 3</td><td>48.1164</td><td>500.00</td><td>500.00</td></tr>
                        <tr><td>N = 5</td><td>24.8906</td><td>500.00</td><td>700.00</td></tr>
                        <tr><td>N = 25</td><td>1.6957</td><td>500.00</td><td>2700.00</td></tr>
                    </tbody>
                </table>

                <h4>\(L_2\) Norm Errors</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{L_2} 10^2\)</th>
                            <th>\(||e^{M}||_{L_2} 10^2\)</th>
                            <th>\(||e^{Q}||_{L_2} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>13.0566</td><td>62.6161</td><td>173.2051</td></tr>
                        <tr><td>N = 3</td><td>4.1095</td><td>49.0001</td><td>223.6068</td></tr>
                        <tr><td>N = 5</td><td>1.8450</td><td>41.5400</td><td>264.5751</td></tr>
                        <tr><td>N = 25</td><td>0.0660</td><td>21.2286</td><td>519.6152</td></tr>
                    </tbody>
                </table>

                <div class="remark-box">
                    <h4>Remarks</h4>
                    <ul>
                        <li>As guaranteed by the Ritz method, the displacements converge in the inf norm (and, consequently, also in the \(L_2\) norm).</li>
                        <li>The bending moment does not converge locally (inf norm), but only globally. This is due to the presence of a discontinuity in x=l/2.</li>
                        <li>The shear, for which convergence is not guaranteed, does not converge, nor in the inf norm, nor in the \(L_2\) norm.</li>
                    </ul>
                </div>

                <h3>Comparison of Bending Moment (N=1,...,25 terms)</h3>
                <p>Despite the presence of a discontinuity, the convergence of the bending moment is guaranteed at global level. As seen in the figure, the quality of the approximation improves for increasing number of functions.</p>

                <h3>Comparison of Internal Shear (N=1,...,25 terms)</h3>
                <p>On the contrary, the shear does not converge, nor locally, nor globally. As seen in the two figures, the approximation of the behavior is poor, even when the number of functions is relatively high.</p>
                <p>Note again the strong oscillations associated with the use of polynomials (despite the field to be represented does not display any discontinuity).</p>
            </section>

            <!-- Example 4: Cantilever Beam with Distributed Load -->
            <section class="section example-section" id="example-4">
                <h2>Example 4: Cantilever Beam with Distributed Load</h2>

                <figure class="diagram">
                    <img src="images/Lab_02_Ritz_beams/cantilever_beam_distributed_load.png" alt="Cantilever beam with uniformly distributed load q over entire length, showing fixed support at left end and beam properties EJ,l">
                    <figcaption>Figure 4: Cantilever beam with uniformly distributed load</figcaption>
                </figure>

                <div class="two-column">
                    <div class="boxed">
                        <h4>Essential Conditions</h4>
                        \[\begin{cases} w(0) = 0 \\ w_{,x}(0) = 0 \end{cases}\]
                    </div>
                    
                    <div class="boxed">
                        <h4>Ritz Functions</h4>
                        \[\phi(x)_i = 1 - \cos \frac{i\pi x}{l} \quad i = 1 \ldots N\]
                    </div>
                </div>

                <div class="two-column">
                    <div class="boxed">
                        <h4>Nondimensional Parameters</h4>
                        \[\overline{w} = w \frac{EJ}{ql^4} \quad \overline{M} = M \frac{1}{ql^2}\]
                        \[\overline{Q} = Q \frac{1}{ql} \quad \overline{\Pi} = \Pi \frac{EJ}{q^2 l^5}\]
                    </div>
                    
                    <div class="boxed">
                        <h4>Exact Solution</h4>
                        \[w = \frac{ql^4}{24EJ} \left[ \left(\frac{x}{l}\right)^4 - 4\left(\frac{x}{l}\right)^3 + 6\left(\frac{x}{l}\right)^2 \right]\]
                        \[M = -ql^2 \left[ \frac{1}{2}\left(\frac{x}{l}\right)^2 - \frac{x}{l} + \frac{1}{2} \right]\]
                        \[Q = -ql\left(\frac{x}{l} - 1\right)\]
                        \[\Pi = -\frac{q^2 l^5}{40EJ}\]
                    </div>
                </div>

                <h3>Remarks on the Shape Functions</h3>
                
                <p>A few remarks on the shape functions \(\phi(x)_i = 1 - \cos \frac{i\pi x}{l} \quad i = 1 \ldots N\):</p>
                <ul>
                    <li>They respect the essential conditions</li>
                    <li>They are \(C^{\infty}\), thus satisfy the requirements of the problem in terms of regularity</li>
                    <li>They are a complete set of functions (if completeness is intended as ability to represent any function in the norm \(L_2\))</li>
                </ul>

                <p>The problem is characterized by continuous displacement, moment and shear. Convergence is then expected in the inf norm for displacements and bending moments. Although not guaranteed, convergence could be reasonably expected also for the shear, given the regularity of the solution.</p>

                <h3>The "Paradox Lost"</h3>

                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(\overline{w}(l/2) \cdot 10^2\)</th>
                            <th>\(\overline{M}(l/2) \cdot 10\)</th>
                            <th>\(\overline{\Pi} \cdot 10^3\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>2.0532</td><td>-0.0000</td><td>-10.2660</td></tr>
                        <tr><td>N = 10</td><td>2.3432</td><td>0.4248</td><td>-11.1082</td></tr>
                        <tr><td>N = 25</td><td>2.3437</td><td>0.4151</td><td>-11.1109</td></tr>
                        <tr><td>N = 100</td><td>2.3437</td><td>0.4166</td><td>-11.1111</td></tr>
                        <tr><td>exact</td><td>4.4271</td><td>-1.2500</td><td>-25.0000</td></tr>
                    </tbody>
                </table>

                <h4>\(L_2\) Norm Errors</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{L_2} 10^2\)</th>
                            <th>\(||e^{M}||_{L_2} 10^2\)</th>
                            <th>\(||e^{Q}||_{L_2} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>60.6619</td><td>76.7698</td><td>62.6158</td></tr>
                        <tr><td>N = 10</td><td>58.8418</td><td>74.5435</td><td>24.0551</td></tr>
                        <tr><td>N = 25</td><td>58.8353</td><td>74.5361</td><td>15.4476</td></tr>
                        <tr><td>N = 100</td><td>58.8349</td><td>74.5356</td><td>7.8422</td></tr>
                    </tbody>
                </table>

                <div class="warning-box">
                    <h4>Remark</h4>
                    <ul>
                        <li><span class="underline">The solution does not converge to the exact result</span> (nor the displacements, nor the moments, nor the energies)!</li>
                        <li>The \(L_2\) error over the displacements is well beyond 60% when 100 functions are used.</li>
                        <li>The Ritz method seems to fail. This is the «Paradox Lost» discussed by Storch and Strang*. The interested reader is strongly suggested to read the paper.</li>
                    </ul>
                </div>

                <div class="note-box">
                    <h4>Note</h4>
                    <p>The quality of the approximate solution is very poor, even for the displacement field!</p>
                </div>

                <h3>On the Completeness of the Trial Functions</h3>

                <p><strong>Why does the Ritz method apparently fail?</strong></p>
                <p>Because <span class="underline">the choice of the trial function is wrong</span>, and indeed they do not satisfy the requirement on the completeness.</p>

                <p><strong>The question to be answered is then: <span class="underline">what does completeness mean</span>?</strong></p>
                <p>Completeness is the ability of representing a generic function \(f\) with the desired level of accuracy. The "level of accuracy" is the distance between the function \(f\) and its expansion in trigonometric series according to a given norm.</p>

                <p>The common way of intending completeness refers to the \(L_2\) distance between the functions:</p>
                \[||e^f||_{L_2} = \sqrt{\int_0^l \left(f - \tilde{f}\right)^2 \text{d}x}\]
                <p>where \(f\) is the generic function and \(\tilde{f}\) is the approximation (trigonometric expansion).</p>

                <p>With this regard, the trial functions here considered are a complete set, and the cosine expansion allows to represent any function \(f\), by progressively reducing the \(L_2\) distance with \(f\).</p>

                <h4>The Key Point</h4>
                <p>This is the key-point: completeness, in the context of the Ritz method, refers to a norm which is not the \(L_2\) one. The correct norm to measure the distance between the approximated function and the exact one is the <span class="underline">energy norm</span>, which is descending from the variational formulation of the problem. For the problem at hand, the internal energy reads:</p>
                \[U = \frac{1}{2} \int_0^a EJ w_{,xx}^2 \text{d}x\]

                <p>The energy norm is then associated with the second derivatives, which are the ones entering the expression of the internal energy \(U\). So the correct norm is:</p>
                \[||e^f||_{energy} = \sqrt{\int_0^l \left(f_{,xx} - \tilde{f}_{,xx}\right)^2 \text{d}x}\]

                <p>The trial functions used for approximating \(f\) must then guarantee the ability of reaching arbitrary accuracy in the description of the second derivatives.</p>

                <p>The question is then: can the trigonometric functions come arbitrarily close to any function according to the energy norm? <span class="underline">The answer is no</span>.</p>

                <h4>Analysis of Second Derivatives</h4>
                <p>Indeed, the second derivative of the exact solution is:</p>
                \[f = w_{,xx} = \frac{ql^2}{EJ} \left[ \frac{1}{2}\left(\frac{x}{l}\right)^2 - \frac{x}{l} + \frac{1}{2} \right]\]

                <p>while the second derivatives of the trial functions are:</p>
                \[\tilde{f} = c_i \phi(x)_{i,xx} = c_i \left(\frac{\pi i}{l}\right)^2 \cos \frac{i\pi x}{l}\]

                <p>As observed, the second derivatives of the approximate solution are missing the <strong style="color: red;">constant term</strong> (which is not null in the exact solution). It follows that the trial functions are not complete (the constant term is missing) and the distance in the energy norm cannot be arbitrarily reduced by increasing the number of terms.</p>

                <h3>Solution of the Paradox</h3>

                <p>A <span class="underline">complete, in the energy norm sense</span>, trigonometric expansion would be:</p>
                \[\tilde{f} = c_i \phi_{i,xx} = c_0 + c_1 \left(\frac{\pi x}{l}\right) \cos \frac{\pi x}{l} + c_2 \left(\frac{\pi x}{l}\right)^2 \cos \frac{2\pi x}{l} + \ldots\]

                <p>which is obtained by introducing a quadratic term in the set of trial functions:</p>
                \[\phi(x)_1 = x^2\]
                \[\phi(x)_i = 1 - \cos \frac{(i-1)\pi x}{l} \quad i = 2 \ldots N\]

                <h4>Results Using Functions with Quadratic Term</h4>

                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(\overline{w}(l/2) \cdot 10^2\)</th>
                            <th>\(\overline{M}(l/2) \cdot 10\)</th>
                            <th>\(\overline{\Pi} \cdot 10^3\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>2.0833</td><td>-1.6667</td><td>-13.8889</td></tr>
                        <tr><td>N = 3</td><td>4.3932</td><td>-1.1601</td><td>-24.7965</td></tr>
                        <tr><td>N = 10</td><td>4.4261</td><td>-1.2621</td><td>-24.9960</td></tr>
                        <tr><td>N = 25</td><td>4.4270</td><td>-1.2516</td><td>-24.9998</td></tr>
                        <tr><td>exact</td><td>4.4271</td><td>-1.2500</td><td>-25.0000</td></tr>
                    </tbody>
                </table>

                <h4>\(L_2\) Norm Errors (with Quadratic Term)</h4>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>\(||e^{\overline{w}}||_{L_2} 10^2\)</th>
                            <th>\(||e^{M}||_{L_2} 10^2\)</th>
                            <th>\(||e^{Q}||_{L_2} 10^2\)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>N = 1</td><td>41.9314</td><td>66.6667</td><td>100.0000</td></tr>
                        <tr><td>N = 3</td><td>0.7091</td><td>9.0224</td><td>48.9993</td></tr>
                        <tr><td>N = 10</td><td>0.0129</td><td>1.2603</td><td>25.2869</td></tr>
                        <tr><td>N = 25</td><td>0.0007</td><td>0.3054</td><td>15.7590</td></tr>
                    </tbody>
                </table>

                <div class="convergence-box">
                    <h4>Note</h4>
                    <p>Convergence of the solution is then achieved in all the relevant quantities (displacements, moments, shear), as initially expected. <span class="underline">The trust in the Ritz method can been restored!</span></p>
                </div>

                <div class="reference">
                    <p>*J. Storch, G. Strang, "Paradox Lost: Natural Boundary Conditions in the Ritz-Galerkin Method", International Journal for Numerical Methods in Engineering, Vol. 26, 1988, pp. 2255-2266.</p>
                </div>
            </section>

        </main>

        <footer style="text-align: center; margin-top: 50px; padding: 20px; color: #666; border-top: 1px solid var(--border-color);">
            <p>Course of Spacecraft Structures, AY 2017/2018</p>
            <p>Politecnico di Milano, Department of Aerospace Science and Technology</p>
        </footer>
    </article>
</body>
</html>